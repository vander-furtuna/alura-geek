import { deleteProduct } from '../api/api';
import { Product } from '../types/product';
import { showProducts } from './productActions';

export function createProductComponent({ id, image, name, price }: Product) {
    const productComponent = document.createElement('div');
    productComponent.className = 'product_card';
    productComponent.innerHTML = `
      <img src="${image}" alt="Imagem do produto ${name}" />
      <span title="${name}">${name}</span>
      <strong>R$ ${String(price.toFixed(2)).replace('.', ',')}</strong>
  `;

    const button = document.createElement('button');
    button.classList.add('product_delete_button');
    button.title = 'Deletar produto';
    button.addEventListener('click', async () => {
        await deleteProduct(id!);
        showProducts();
    });
    button.innerHTML = `
        <img
            src="data:image/svg+xml,%3csvg%20width='20'%20height='20'%20viewBox='0%200%2020%2020'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M19%204.00022H14V2.33022C13.9765%201.69004%2013.7002%201.08528%2013.2316%200.648511C12.7629%200.211745%2012.1402%20-0.0213881%2011.5%200.000218771H8.5C7.85976%20-0.0213881%207.23706%200.211745%206.76843%200.648511C6.2998%201.08528%206.02346%201.69004%206%202.33022V4.00022H1C0.734784%204.00022%200.48043%204.10558%200.292893%204.29311C0.105357%204.48065%200%204.735%200%205.00022C0%205.26544%200.105357%205.51979%200.292893%205.70733C0.48043%205.89486%200.734784%206.00022%201%206.00022H2V17.0002C2%2017.7959%202.31607%2018.5589%202.87868%2019.1215C3.44129%2019.6842%204.20435%2020.0002%205%2020.0002H15C15.7957%2020.0002%2016.5587%2019.6842%2017.1213%2019.1215C17.6839%2018.5589%2018%2017.7959%2018%2017.0002V6.00022H19C19.2652%206.00022%2019.5196%205.89486%2019.7071%205.70733C19.8946%205.51979%2020%205.26544%2020%205.00022C20%204.735%2019.8946%204.48065%2019.7071%204.29311C19.5196%204.10558%2019.2652%204.00022%2019%204.00022ZM8%2014.0002C8%2014.2654%207.89464%2014.5198%207.70711%2014.7073C7.51957%2014.8949%207.26522%2015.0002%207%2015.0002C6.73479%2015.0002%206.48043%2014.8949%206.29289%2014.7073C6.10536%2014.5198%206%2014.2654%206%2014.0002V10.0002C6%209.735%206.10536%209.48065%206.29289%209.29311C6.48043%209.10558%206.73479%209.00022%207%209.00022C7.26522%209.00022%207.51957%209.10558%207.70711%209.29311C7.89464%209.48065%208%209.735%208%2010.0002V14.0002ZM8%202.33022C8%202.17022%208.21%202.00022%208.5%202.00022H11.5C11.79%202.00022%2012%202.17022%2012%202.33022V4.00022H8V2.33022ZM14%2014.0002C14%2014.2654%2013.8946%2014.5198%2013.7071%2014.7073C13.5196%2014.8949%2013.2652%2015.0002%2013%2015.0002C12.7348%2015.0002%2012.4804%2014.8949%2012.2929%2014.7073C12.1054%2014.5198%2012%2014.2654%2012%2014.0002V10.0002C12%209.735%2012.1054%209.48065%2012.2929%209.29311C12.4804%209.10558%2012.7348%209.00022%2013%209.00022C13.2652%209.00022%2013.5196%209.10558%2013.7071%209.29311C13.8946%209.48065%2014%209.735%2014%2010.0002V14.0002Z'%20fill='white'/%3e%3c/svg%3e"
            alt="Icone de Lixeira"
        />
    `;

    productComponent.appendChild(button);

    return productComponent;
}
